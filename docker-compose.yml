
  services:

    auth-service:
      build: ./auth-service
      ports:
        - "5000:5000"
      env_file:
        - ./auth-service/.env
      volumes:
        - ./auth-service:/app
        - ./auth-service/auth_data:/app/auth_data

    persona-backend:
      build: ./persona-service/backend
      ports:
        - "5001:5001"
      env_file:
      - ./persona-service/backend/.env
      volumes:
        - ./persona-service/backend:/app
        - ./persona-service/backend/persona.db:/app/persona.db

    persona-frontend:
      build: ./persona-service/frontend
      ports:
        - "5173:5173"
      env_file:
        - ./persona-service/frontend/.env

    component-service:
      build: ./component-services
      ports:
        - "5002:5002"
      env_file:
        - ./component-services/.env
      volumes:
        - ./component-services:/app
      environment:
        - SERVICES_CONFIG_FILE=services-docker.json
        - RUN_ON_DOCKER=True
      depends_on:
        - auth-service
        - persona-backend

    redis:
      image: redis:latest
      container_name: redis-dev
      ports:
        - "6379:6379"


    mysql:
      image: mysql:5.7
      container_name: mysql-persona
      restart: unless-stopped
      environment:
        MYSQL_ROOT_PASSWORD: rootpass
        MYSQL_DATABASE: persona_db
        MYSQL_USER: persona_user
        MYSQL_PASSWORD: persona_pass
      ports:
        - "3306:3306"  # El 3307 es el puerto en tu m√°quina host (no pisa XAMPP en 3306)
      volumes:
        - mysql_data:/var/lib/mysql

  volumes:
    mysql_data: